<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="../css/style.css">
    <title>Teeworlds Protocol</title>
</head>
<body>
    <div class="header">
        <a href="../index.html">
            <img src="../img/tee.svg" alt="tee">
        </a>
        <a href="../index.html">home</a>
        <a href="traffic.html">traffic</a>
        <a href="snap_items.html">snap_items</a>
        <a href="system_messages.html">system_messages</a>
        <a href="game_messages.html">game_messages</a>
        <hr>
    </div>
    <div class="content">
        <h2>List of network system messages</h2>
        <p>
            There are two types of messages: system messages and game messages <br>
            This list is only covering system messages. Game messages can be found <a href="game_messages.html">here</a>. <br>
            <br>
            When the client and server exchange packets.
            One integer field which usually does not exceed one byte.
            Is indicating which type of message was sent.
            This field is called the message id.
            These message ids are defined in
            <a href="https://github.com/teeworlds/teeworlds/blob/26d24ec061d44e6084b2d77a9b8a0a48e354eba6/src/engine/shared/protocol.h#L31-L76">
                src/engine/shared/protocol.h
            </a>
            and their payload is defined where they are sent and received.
            <br>
            <br>
            In the list below you will find those message.
            With their name, id and payload.
        </p>
        <hr>
        <h3 id="NETMSG_NULL"><a href="#NETMSG_NULL">NETMSG_NULL</a></h3>
        <p>
            <strong>Message ID:</strong> 0 <br>
        </p>
        <hr>
        <h3 id="NETMSG_INFO"><a href="#NETMSG_INFO">NETMSG_INFO</a></h3>
        <p>
            <strong>Sender:</strong>  <br>
            <strong>Recipient:</strong>  <br>
            <strong>Message ID:</strong> 1 <br>
        </p>
        <hr>
        <h3 id="NETMSG_MAP_CHANGE"><a href="#NETMSG_MAP_CHANGE">NETMSG_MAP_CHANGE</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 2 <br>
            Sent when client should switch map
            <br>
            Sent by the server in
            <a href="https://github.com/teeworlds/teeworlds/blob/26d24ec061d44e6084b2d77a9b8a0a48e354eba6/src/engine/server/server.cpp#L709-L719">
                CServer::SendMap(int ClientID)
            </a>
            <pre class="code-snippet">
                <code>
    CMsgPacker Msg(NETMSG_MAP_CHANGE, true);
    Msg.AddString(GetMapName(), 0);
    Msg.AddInt(m_CurrentMapCrc);
    Msg.AddInt(m_CurrentMapSize);
    Msg.AddInt(m_MapChunksPerRequest);
    Msg.AddInt(MAP_CHUNK_SIZE);
    Msg.AddRaw(&m_CurrentMapSha256, sizeof(m_CurrentMapSha256));
    SendMsg(&Msg, MSGFLAG_VITAL|MSGFLAG_FLUSH, ClientID);
                </code>
            </pre>
            Unpacked by the client in
            <a href="https://github.com/teeworlds/teeworlds/blob/master/src/engine/client/client.cpp#L1150-L1222">
                CClient::ProcessServerPacket(CNetChunk *pPacket)
            </a>
            <pre class="code-snippet">
                <code>
    const char *pMap = Unpacker.GetString(CUnpacker::SANITIZE_CC|CUnpacker::SKIP_START_WHITESPACES);
    int MapCrc = Unpacker.GetInt();
    int MapSize = Unpacker.GetInt();
    int MapChunkNum = Unpacker.GetInt();
    int MapChunkSize = Unpacker.GetInt();
    if(Unpacker.Error())
        return;
    const SHA256_DIGEST *pMapSha256 = (const SHA256_DIGEST *)Unpacker.GetRaw(sizeof(*pMapSha256));
                </code>
            </pre>
        </p>
        <hr>
        <h3 id="NETMSG_MAP_DATA"><a href="#NETMSG_MAP_DATA">NETMSG_MAP_DATA</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 3 <br>
            map transfer, contains a chunk of the map file
        </p>
        <hr>
        <h3 id="NETMSG_SERVERINFO"><a href="#NETMSG_SERVERINFO">NETMSG_SERVERINFO</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 4 <br>
        </p>
        <hr>
        <h3 id="NETMSG_CON_READY"><a href="#NETMSG_CON_READY">NETMSG_CON_READY</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 5 <br>
            connection is ready, client should send start info
        </p>
        <hr>
        <h3 id="NETMSG_SNAP"><a href="#NETMSG_SNAP">NETMSG_SNAP</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 6 <br>
            normal snapshot, multiple parts
        </p>
        <hr>
        <h3 id="NETMSG_SNAPEMPTY"><a href="#NETMSG_SNAPEMPTY">NETMSG_SNAPEMPTY</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 7 <br>
            empty snapshot
        </p>
        <hr>
        <h3 id="NETMSG_SNAPSINGLE"><a href="#NETMSG_SNAPSINGLE">NETMSG_SNAPSINGLE</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 8 <br>
        </p>
        <hr>
        <h3 id="NETMSG_SNAPSMALL"><a href="#NETMSG_SNAPSMALL">NETMSG_SNAPSMALL</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 9 <br>
        </p>
        <hr>
        <h3 id="NETMSG_INPUTTIMING"><a href="#NETMSG_INPUTTIMING">NETMSG_INPUTTIMING</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 10 <br>
            reports how off the input was
        </p>
        <hr>
        <h3 id="NETMSG_RCON_AUTH_ON"><a href="#NETMSG_RCON_AUTH_ON">NETMSG_RCON_AUTH_ON</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 11 <br>
            rcon authentication enabled
        </p>
        <hr>
        <h3 id="NETMSG_RCON_AUTH_OFF"><a href="#NETMSG_RCON_AUTH_OFF">NETMSG_RCON_AUTH_OFF</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 12 <br>
            rcon authentication disabled
        </p>
        <hr>
        <h3 id="NETMSG_RCON_LINE"><a href="#NETMSG_RCON_LINE">NETMSG_RCON_LINE</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 13 <br>
            line that should be printed to the remote console
        </p>
        <hr>
        <h3 id="NETMSG_RCON_CMD_ADD"><a href="#NETMSG_RCON_CMD_ADD">NETMSG_RCON_CMD_ADD</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 14 <br>
        </p>
        <hr>
        <h3 id="NETMSG_RCON_CMD_REM"><a href="#NETMSG_RCON_CMD_REM">NETMSG_RCON_CMD_REM</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 15 <br>
        </p>
        <hr>
        <h3 id="NETMSG_AUTH_CHALLANGE"><a href="#NETMSG_AUTH_CHALLANGE">NETMSG_AUTH_CHALLANGE</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 16 <br>
        </p>
        <hr>
        <h3 id="NETMSG_AUTH_RESULT"><a href="#NETMSG_AUTH_RESULT">NETMSG_AUTH_RESULT</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 17 <br>
        </p>
        <hr>
        <h3 id="NETMSG_READY"><a href="#NETMSG_READY">NETMSG_READY</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 18 <br>
        </p>
        <hr>
        <h3 id="NETMSG_ENTERGAME"><a href="#NETMSG_ENTERGAME">NETMSG_ENTERGAME</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 19 <br>
        </p>
        <hr>
        <h3 id="NETMSG_INPUT"><a href="#NETMSG_INPUT">NETMSG_INPUT</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 20 <br>
            contains the inputdata from the client
        </p>
        <hr>
        <h3 id="NETMSG_RCON_CMD"><a href="#NETMSG_RCON_CMD">NETMSG_RCON_CMD</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 21 <br>
        </p>
        <hr>
        <h3 id="NETMSG_RCON_AUTH"><a href="#NETMSG_RCON_AUTH">NETMSG_RCON_AUTH</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 22 <br>
        </p>
        <hr>
        <h3 id="NETMSG_REQUEST_MAP_DATA"><a href="#NETMSG_REQUEST_MAP_DATA">NETMSG_REQUEST_MAP_DATA</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 23 <br>
        </p>
        <hr>
        <h3 id="NETMSG_AUTH_START"><a href="#NETMSG_AUTH_START">NETMSG_AUTH_START</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 24 <br>
        </p>
        <hr>
        <h3 id="NETMSG_AUTH_RESPONSE"><a href="#NETMSG_AUTH_RESPONSE">NETMSG_AUTH_RESPONSE</a></h3>
        <p>
            <strong>Sender:</strong> Client <br>
            <strong>Recipient:</strong> Server <br>
            <strong>Message ID:</strong> 25 <br>
        </p>
        <hr>
        <h3 id="NETMSG_PING"><a href="#NETMSG_PING">NETMSG_PING</a></h3>
        <p>
            <strong>Sender:</strong> Client, Server <br>
            <strong>Recipient:</strong> Client, Server <br>
            <strong>Message ID:</strong> 26 <br>
            sent by both
        </p>
        <hr>
        <h3 id="NETMSG_PING_REPLY"><a href="#NETMSG_PING_REPLY">NETMSG_PING_REPLY</a></h3>
        <p>
            <strong>Sender:</strong> Client, Server <br>
            <strong>Recipient:</strong> Client, Server <br>
            <strong>Message ID:</strong> 27 <br>
            sent by both
        </p>
        <hr>
        <h3 id="NETMSG_ERROR"><a href="#NETMSG_ERROR">NETMSG_ERROR</a></h3>
        <p>
            <strong>Sender:</strong> Client, Server <br>
            <strong>Recipient:</strong> Client, Server <br>
            <strong>Message ID:</strong> 28 <br>
            sent by both
        </p>
        <hr>
        <h3 id="NETMSG_MAPLIST_ENTRY_ADD"><a href="#NETMSG_MAPLIST_ENTRY_ADD">NETMSG_MAPLIST_ENTRY_ADD</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 29 <br>
            the msg id is planned to be changed in 0.8
        </p>
        <hr>
        <h3 id="NETMSG_MAPLIST_ENTRY_REM"><a href="#NETMSG_MAPLIST_ENTRY_REM">NETMSG_MAPLIST_ENTRY_REM</a></h3>
        <p>
            <strong>Sender:</strong> Server <br>
            <strong>Recipient:</strong> Client <br>
            <strong>Message ID:</strong> 30 <br>
            the msg id is planned to be changed in 0.8
        </p>
    </div> <!-- content -->
    <footer>
        <hr>
        <div class="footer">
            <!-- Icon-link to source code on GitHub -->
            <a class="github" href="https://github.com/ChillerDragon/teeworlds-protocol" target="_blank" rel="noopener" aria-label="Source code">
                <!-- icon: https://materialdesignicons.com/icon/github -->
                <svg viewBox="0 0 24 24" class="github">
                    <path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z" />
                </svg>
            </a>
            <span>
                ChillerDragon - 2022
            </span>
        </div>
    </footer>
</body>
